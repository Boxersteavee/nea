---
import { Image } from 'astro:assets';
import { getFamilyTitle } from '@components/FamilyTitle';
const name = await getFamilyTitle(Astro.url.origin);
---
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="stylesheet" href="/css/style.css">
<div class="container">
    <h1 class="title">{name}</h1>
    <Image src="/images/logo.svg" alt="Logo" class="logo" width={500} height={500} loading="eager"/>
    <div class="form">
        <button onclick="window.location.href='/login'">Login!</button>
        <button onclick="window.location.href='/register'">Register!</button>
    </div>
</div>

<script>
    // Call API to check if the session is valid, if the response is 200 OK, redirect to /home
    async function checkSession() {
        try {
            const response = await fetch('/api/checksession', {
                credentials: 'include'
            });
            if (response.status === 200) {
                window.location.href = '/home';
            }
        } catch (error) {
            // No valid session, stay on page
        }
    }

    checkSession();
</script>